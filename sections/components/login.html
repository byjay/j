<div id="login-screen"
    class="fixed inset-0 z-50 flex flex-col items-center justify-center p-4 transition-opacity duration-300"
    style="background-image: url('images/BACK.png'); background-size: contain; background-repeat: no-repeat; background-position: center; background-color: #000;">

    <div class="bg-white/80 backdrop-blur-sm p-6 rounded-3xl shadow-2xl w-full max-w-md border border-white/50">
        <!-- 로고 영역: 세로 중앙 정렬 -->
        <div class="text-center mb-6">
            <img src="images/app_icon.png" alt="JAP-BONG" class="w-16 h-16 mx-auto rounded-2xl shadow-lg mb-3">
            <h1 class="text-2xl font-black text-red-600 tracking-tight">JAP-BONG</h1>
            <p class="text-sm text-gray-500 mt-1">아빠가 만든 가족 일본어 앱 🍌</p>
        </div>

        <!-- Family Login Grid -->
        <div class="grid grid-cols-2 gap-4">
            <div class="user-card group bg-white p-3 rounded-2xl shadow-md hover:shadow-xl border-2 border-transparent hover:border-red-400 flex flex-col items-center cursor-pointer transition-all duration-200 transform hover:-translate-y-1"
                onclick="showPasswordPrompt()">
                <div
                    class="w-16 h-16 mb-2 rounded-full overflow-hidden border-4 border-gray-100 group-hover:border-red-100 transition-colors">
                    <img src="images/dad.png" alt="아빠" class="w-full h-full object-cover">
                </div>
                <h3 class="text-lg font-bold text-gray-800 group-hover:text-red-600">아빠</h3>
            </div>
            <div class="user-card group bg-white p-3 rounded-2xl shadow-md hover:shadow-xl border-2 border-transparent hover:border-pink-400 flex flex-col items-center cursor-pointer transition-all duration-200 transform hover:-translate-y-1"
                onclick="showMomPasswordPrompt()">
                <div
                    class="w-16 h-16 mb-2 rounded-full overflow-hidden border-4 border-gray-100 group-hover:border-pink-100 transition-colors">
                    <img src="images/mom_orig.png" alt="엄마" class="w-full h-full object-cover">
                </div>
                <h3 class="text-lg font-bold text-gray-800 group-hover:text-pink-600">엄마</h3>
            </div>
            <div class="user-card group bg-white p-3 rounded-2xl shadow-md hover:shadow-xl border-2 border-transparent hover:border-purple-400 flex flex-col items-center cursor-pointer transition-all duration-200 transform hover:-translate-y-1"
                onclick="showSieunPasswordPrompt()">
                <div
                    class="w-16 h-16 mb-2 rounded-full overflow-hidden border-4 border-gray-100 group-hover:border-purple-100 transition-colors">
                    <img src="images/sieun.png" alt="시으니" class="w-full h-full object-cover">
                </div>
                <h3 class="text-lg font-bold text-gray-800 group-hover:text-purple-600">시으니</h3>
            </div>
            <div class="user-card group bg-white p-3 rounded-2xl shadow-md hover:shadow-xl border-2 border-transparent hover:border-blue-400 flex flex-col items-center cursor-pointer transition-all duration-200 transform hover:-translate-y-1"
                onclick="showHarongPasswordPrompt()">
                <div
                    class="w-16 h-16 mb-2 rounded-full overflow-hidden border-4 border-gray-100 group-hover:border-blue-100 transition-colors">
                    <img src="images/harong.png" alt="하롱이" class="w-full h-full object-cover">
                </div>
                <h3 class="text-lg font-bold text-gray-800 group-hover:text-blue-600">하롱이</h3>
            </div>
        </div>

        <!-- 손님 체험하기 버튼 -->
        <div class="mt-4">
            <button title="Button" aria-label="Button" onclick="showGuestLoginModal()"
                class="w-full bg-gradient-to-r from-amber-400 to-orange-500 text-white p-3 rounded-2xl shadow-md hover:shadow-lg transition-all duration-200 flex items-center justify-center gap-3 group">
                <span class="text-2xl">🐿️</span>
                <div class="text-left">
                    <span class="font-bold text-base">손님 체험하기</span>
                    <p class="text-xs text-amber-100">이름과 캐릭터를 선택하세요</p>
                </div>
            </button>
        </div>

        <div class="mt-4 text-center">
            <p class="text-[10px] text-gray-400 font-mono">BUILD: <span id="def-build-time">Loading...</span></p>
        </div>
    </div>
</div>

<!-- ★★★ 손님 로그인 모달 (캐릭터 먼저 선택) ★★★ -->
<div id="guest-login-modal"
    class="fixed inset-0 z-[200] bg-black/70 backdrop-blur-sm hidden items-center justify-center p-4">
    <div class="bg-white rounded-3xl shadow-2xl w-full max-w-md max-h-[90vh] overflow-hidden flex flex-col">
        <!-- Header -->
        <div class="bg-gradient-to-r from-amber-500 to-orange-500 p-4 text-white text-center relative">
            <button title="Button" aria-label="Button" onclick="closeGuestLoginModal()"
                class="absolute top-4 right-4 text-white/80 hover:text-white">
                <i class="fas fa-times text-xl"></i>
            </button>
            <h2 class="text-xl font-black">🎉 손님으로 시작하기</h2>
            <p class="text-sm text-amber-100">캐릭터를 선택하세요!</p>
        </div>

        <!-- Step 1: Avatar Selection (First!) -->
        <div id="guest-step-1" class="p-4 flex-1 overflow-y-auto">
            <p class="text-center text-gray-600 font-bold mb-3">나를 나타낼 캐릭터를 선택하세요!</p>
            <div id="guest-avatar-grid" class="grid grid-cols-3 gap-3">
                <!-- Avatars populated by JS -->
            </div>
        </div>

        <!-- Step 2: Name Input (After character selection) -->
        <div id="guest-step-2" class="hidden p-6 flex-1">
            <div class="text-center mb-4">
                <img alt="Image" id="selected-avatar-preview" src="images/sieun.png"
                    class="w-20 h-20 rounded-full mx-auto border-4 border-amber-200 shadow-lg mb-2">
                <p class="text-sm text-gray-500">선택한 캐릭터</p>
            </div>
            <label class="block text-gray-700 font-bold mb-2">닉네임 (선택사항)</label>
            <input type="text" id="guest-name-input" maxlength="10" placeholder="기본: 선택한 캐릭터 이름"
                class="w-full px-4 py-3 border-2 border-gray-200 rounded-xl text-lg focus:border-amber-500 focus:outline-none transition-colors">
            <p class="text-xs text-gray-400 mt-1">비워두면 캐릭터 이름으로 설정됩니다</p>

            <div class="flex gap-3 mt-6">
                <button title="Button" aria-label="Button" onclick="guestBackToAvatars()"
                    class="flex-1 py-3 bg-gray-100 text-gray-600 rounded-xl font-bold hover:bg-gray-200 transition">
                    ← 캐릭터 다시 선택
                </button>
                <button title="Button" aria-label="Button" onclick="completeGuestLogin()"
                    class="flex-1 py-3 bg-gradient-to-r from-amber-500 to-orange-500 text-white font-bold rounded-xl shadow-md transition-all hover:shadow-lg">
                    시작하기! 🚀
                </button>
            </div>
        </div>
    </div>
</div>